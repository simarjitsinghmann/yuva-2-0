{% layout none %}
{% if request.path == '/cart' %}
{% for item in cart.items %}
<tr>
  <td class="cart-img">
    <a href="{{item.url}}">
      <img src="{{item.image | img_url:'100x'}}" alt="">
    </a>
  </td>
  <td class="cart-prd-details">

    <a href="{{item.url}}"><h5>{{item.product.title | truncatewords:5}}</h5></a>
    <div class="cart-item-product-details">
      {% unless item.variant.title == null or item.variant.title == 'Default Title'%}
      {% for option in item.options_with_values %}
      <span>{{option.name}}: {{option.value}}</span>
      {% endfor %}
      {% endunless %}	
      <h6>{{item.selling_plan_allocation.selling_plan.name }}</h6>

      <div class="price item-price" data-item-price="{{forloop.index0}}">
        {%- if item.original_price != item.final_price -%}
        <s class="cart-item__old-price product-option">
          {{- item.original_price | money -}}
        </s>
        <strong class="cart-item__final-price product-option">
          {{ item.final_price | money }}
        </strong>
        {% else %}
        <strong class="cart-item__final-price product-option">
          {{ item.original_price | money }}
        </strong>
        {% endif %}
      </div>
      <ul class="discounts list-unstyled" role="list" aria-label="{{ 'customer.order.discount' | t }}" data-item-discount="{{forloop.index0}}">
        {%- for discount in item.discounts -%}
        <li class="discounts__discount coupanName">
          <i class="fas fa-tag"></i> 
          <small class="item__discount">{{ discount.title }}</small>
        </li>
        {%- endfor -%}
      </ul>
      {%- for property in item.properties -%}
      {%- assign property_first_char = property.first | slice: 0 -%}
      {%- if property.last != blank and property_first_char != '_' -%}
      <span><strong>{{ property.first }}</strong>: 
        {%- if property.last contains '/uploads/' -%}
        <a href="{{ property.last }}" target="_blank">
          {{ property.last | split: '/' | last }}
        </a>
        {%- else -%}
        {{ property.last }}
        {%- endif -%}
      </span>
      {%- endif -%}
      {%- endfor -%}
    </div>

  </td>
  <td class="cart-qty">
    <div class="qty">
      <button class="minus line_item_change"  data-line="{{forloop.index}}">-</button>
      <input type="number" name="item_quantity" initial="{{item.quantity}}" data-line="{{forloop.index}}" value="{{item.quantity}}" data-line-quantity="{{forloop.index0}}">
      <button class="plus line_item_change" data-line="{{forloop.index}}">+</button>
    </div>
  </td>
  <td class="cart-price">                 

    <div class="price item-line-price" data-line-price="{{forloop.index0}}">
      {%- if item.original_line_price != item.final_line_price -%}
      <s class="cart-item__old-price product-option">
        {{- item.original_line_price | money -}}
      </s>
      <strong class="cart-item__final-price product-option">
        {{ item.final_line_price | money }}
      </strong>
      {% else %}
      <strong class="cart-item__final-price product-option">
        {{ item.original_line_price | money }}
      </strong>
      {% endif %}
    </div>
    {%- if item.unit_price_measurement -%}
    <small class="unit-price">
      {{ item.variant.unit_price | money }}
      /
      {%- if item.variant.unit_price_measurement.reference_value != 1 -%}
      {{- item.variant.unit_price_measurement.reference_value -}}
      {%- endif -%}
      {{ item.variant.unit_price_measurement.reference_unit }}
    </small>
    {%- endif -%}
  </td>
  <td class="cart-remove">
    <div class="remove line_item_remove" data-line="{{forloop.index}}">
      <svg line="1" xmlns="http://www.w3.org/2000/svg" width="11" height="11" viewBox="0 0 11 11">
        <path id="Forma_1" data-name="Forma 1" d="M1873.46,42.5l4.32-4.328a0.687,0.687,0,1,0-.97-0.973l-4.32,4.328-4.32-4.328a0.687,0.687,0,1,0-.97.973l4.32,4.328-4.32,4.329a0.688,0.688,0,0,0,.49,1.175,0.674,0.674,0,0,0,.48-0.2l4.32-4.329,4.32,4.329a0.7,0.7,0,0,0,.49.2,0.674,0.674,0,0,0,.48-0.2,0.686,0.686,0,0,0,0-.973Z" transform="translate(-1867 -37)"></path>
      </svg>
    </div>
  </td>
</tr>
{% endfor %}
{% else %}
{% if cart.item_count > 0 %}
<div id="mini__cartForm">
  <form action="{{ routes.cart_url }}" class="cart__contents critical-hidden" method="post" id="cart" cart-form>
    <div class="cart-item-container">
      {% assign shippingTarget = settings.shipping_rate | times:100%}
      {% if settings.enable_shipping and settings.shipping_rate != blank %}
      {% assign shippingPending = shippingTarget | minus: cart.total_price | money %}
      {% assign shippingPercentage = cart.total_price | times:100 | divided_by:shippingTarget %}
      {% if shippingPercentage > 10 and shippingPercentage < 100 %}
      {% assign shippingPercentage = shippingPercentage | minus:5 %}
      {% endif %}
      {% if cart.total_price < shippingTarget %}
      <p>{{settings.shipping_text | replace : '||amount||',shippingPending}}</p>
      {% else %}
      <p>{{settings.free_shipping_text}}</p>
      {% endif %}
      <div class="progress">
        <div class="progress-bar" role="progressbar"
             aria-valuemin="0" aria-valuemax="100" style="width:{{shippingPercentage}}%">
          <span class="sr-only">{{shippingPercentage}}% Complete</span>
        </div>
      </div>
      {% endif %}
      <div class="cart-items-wrapper">
        {% for item in cart.items %}
        <div class="media-link" data-line="{{forloop.index}}">
          <img src="{{item.image | img_url:'150x'}}" alt="{{name}}" width="65" height="73">
          <div class="media-body">
            <h5 class="cart-item-link">
              <a href="{{item.url}}">{{item.product.title | truncatewords:5}}</a>
            </h5>
            {% unless item.variant.title == null or item.variant.title == 'Default Title'%}
            <span class="item-variant-title">{{item.variant.title}}</span>
            {% endunless %}
            <span class="item-variant-title">{{item.selling_plan_allocation.selling_plan.name }}</span>
            <h6 class="product__price">
              {%- if item.original_price != item.final_price -%}
              <small class="item__price-strikethrough"><s>{{item.original_price| money}}</s></small><span>{{item.final_price| money}}</span>
              {%else%}
              <span>{{item.final_price | money}}</span>
              {%- endif -%}

              {%- if item.unit_price_measurement -%}
              <small class="unit-price">
                {{ item.variant.unit_price | money }}
                /
                {%- if item.variant.unit_price_measurement.reference_value != 1 -%}
                {{- item.variant.unit_price_measurement.reference_value -}}
                {%- endif -%}
                {{ item.variant.unit_price_measurement.reference_unit }}
              </small>
              {%- endif -%}
            </h6>
            {%- for discount in item.discounts -%}
            <div class="text-right">
              <small class="item__discount coupanName">{{ discount.title }}</small><br>

            </div>
            {%- endfor -%}
            <div class="right-media-cart">
              <div class="quantity">
                <input type="number" class="ajaxcart__qty-num" name="updates[]" min="1" max="9" step="1" value="{{item.quantity}}" data-id="{{item.key}}" data-line="{{forloop.index}}">
                <div class="quantity-nav">
                  <div class="quantity-button quantity-up ajaxcart__qty--plus"  data-id="{{item.key}}" data-line="{{forloop.index}}" data-qty="{{item.quantity | plus: 1}}"><svg width="24px" height="24px" viewBox="0 0 24 24" role="img" xmlns="http://www.w3.org/2000/svg" aria-labelledby="plusIconTitle" stroke="#909097" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" fill="none" color="#000000"> <title id="plusIconTitle">Plus</title> <path d="M20 12L4 12M12 4L12 20"/> </svg></div>
                  <div class="quantity-button quantity-down ajaxcart__qty--minus" data-id="{{item.key}}" data-line="{{forloop.index}}" data-qty="{{item.quantity | minus: 1}}"><svg width="24px" height="24px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#909097" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" class="feather feather-minus"><line x1="5" y1="12" x2="19" y2="12"></line></svg></div>
                </div>
              </div>
              <div class="sd_mini_removeproduct" line="{{forloop.index}}" >{{'sections.cart.remove' | t}}</div>
            </div>
          </div>

        </div>
        {% endfor %}	
      </div>
    </div>
    <div class="bottom-cart-box">
      <div class="leave-order-note">
        <span class="cartDrawerNote">{{'sections.cart.note_heading' | t}}

        </span>
        <div class="cartNoteContainer" style="display:none">
          <textarea class="form-control" rows = "3" name="note">{{cart.note}}</textarea>
        </div>
      </div>
      <ul>

        {%- if cart.cart_level_discount_applications.size > 0 -%}
        {%- for discount in cart.cart_level_discount_applications -%}
        <li class="minicart__savings">{{'sections.cart.discount' | t}}<span class="coupanName">{{ discount.title }}</span> <strong>-{{discount.total_allocated_amount | money}}</strong></li>

        {% endfor %}	
        {% endif %}
        <li class="totle-price">{{'sections.cart.subtotal' | t}}<strong>{{cart.total_price | money}}</strong></li>
      </ul>
      <small class="bottom-p">{{'sections.cart.taxes_and_shipping_at_checkout' | t}}</small>
      <div class="cart-btn-container">
        <a href="/checkout" class="checkout-btn button black-btn">{{'sections.cart.checkout' | t}}</a>
      </div>
      <a class="shopping_cont" href="/cart">{{'sections.cart.view_cart' | t}}</a>
    </div>
  </form>
</div>
{% else %}
<div class="emptySideCart">
  <img class="emptyCartIcon" src="{{'cart.svg' | asset_url}}">
  <p>{{'sections.cart.empty' | t}}</p>
  <a class="button black-btn" href="/collections/all">{{'general.continue_shopping' | t}}</a>
</div>
{% endif %}
{% endif %}
